# ------------------------------
# CommunityPortalConfig Mutation Definitions
# ------------------------------
extend type Mutation {
    communityPortalConfigUpsert(
        input: CommunityPortalConfigUpsertInput!
        permission: CheckCommunityPermissionInput!
    ): CommunityPortalConfigUpsertPayload!
    @authz(rules: [IsCommunityOwner])
}

# ------------------------------
# CommunityPortalConfig Mutation Input Definitions
# ------------------------------
input CommunityPortalConfigUpsertInput {
    tokenName: String!

    title: String!
    description: String!
    shortDescription: String

    domain: String!

    # 画像 (nullの場合は既存を維持)
    favicon: ImageInput
    logo: ImageInput
    squareLogo: ImageInput
    ogImage: ImageInput

    features: [EnableFeature!]!

    rootPath: String
    adminRootPath: String

    documents: [DocumentInput!]
    commonDocumentOverrides: CommonDocumentOverridesInput

    regionName: String
    regionKey: String
}

input DocumentInput {
    id: String!
    title: String!
    file: Upload        # 新規/更新時のファイル
    path: String        # 既存パスを維持する場合
    type: String!
    order: Int
}

input CommonDocumentOverridesInput {
    terms: DocumentInput
    privacy: DocumentInput
}

# ------------------------------
# CommunityPortalConfig Mutation Success Type Definitions
# ------------------------------
type CommunityPortalConfigUpsertSuccess {
    portalConfig: CommunityPortalConfig!
}

# ------------------------------
# CommunityPortalConfig Mutation Union (Payload) Definitions
# ------------------------------
union CommunityPortalConfigUpsertPayload =
    CommunityPortalConfigUpsertSuccess
